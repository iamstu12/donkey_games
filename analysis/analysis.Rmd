---
title: "Donkey Games"
subtitle: "Final Project"
author: "Stuart McColl"
date: "January 2021"
output:
  html_document:
    df_print: paged
    toc: yes
    toc_float: yes
  pdf_document:
    toc: yes
  word_document:
    toc: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r, include = FALSE}

# read in cleaned data and load libraries:

library(tidyverse)
library(rmarkdown)
library(pander)
library(latexpdf)
library(here)

here::here()

clean_sales_data <- read_csv(here("clean_data", "clean_sales_data.csv"))


```


# Introduction 

The following report provides an exploratory analysis into the sales of video games. The data used for this report contains the global sales of games dating as far back as 1970 through to the present. Having such a vast range of games sales allows for a interesting look in to trends in top games across the years in order to identify what types of games, historically have performed well.

# The Data

### General Observations

**A brief glimpse at the data:**

```{r, echo = FALSE}

clean_sales_data %>% 
  head()

```
The data is an amalgamation of 4 data sets, each with their own set of sales and useful information. The final data contains the most up to date sales figures for each game as of 2019.

<br>

**What are the top 10 games?**

```{r,echo = FALSE}

clean_sales_data %>% 
  slice_max(global_sales, n = 10)

```
The results are interesting; **Nintendo** fill the entire top ten with a mix of retro games and games for the Wii console. Super Mario Bros, which was originally released in 1985 ranked number two in the best selling games. Taking first place is Wii Sports.

<hr>

**What are the top game genres?**

```{r, message=FALSE, echo = FALSE}

clean_sales_data %>% 
  group_by(genre) %>% 
  summarise(global_sales_millions = sum(global_sales)) %>% 
  arrange(desc(global_sales_millions)) %>% 
  
  ggplot(aes(x = reorder(genre, global_sales_millions), 
             y = global_sales_millions)) +
  geom_col(alpha = 0.8, colour = "white", fill = "#cc9900") +
  coord_flip() +
  theme_light() +
  labs(title = "Top Performing Games Genres", 
       subtitle = "from 1970 to 2020",
       x = "Genre", 
       y = "Global Sales (millions)") +
   scale_y_continuous(breaks = c(0, 250, 500, 750, 1000, 1250, 1500, 1750, 2000, 2250),
                     expand = c(0.025, 0.025))


```

<br>

### Action Games

```{r, echo = FALSE, include = F}

# 2016

sales_all_clean %>% 
  select(name, console, year_of_release, genre, publisher, global_sales, sales_year) %>% 
  filter(genre == "Action") %>% 
  filter(sales_year == 2016) %>% 
  slice_max(global_sales, n = 5)

```

```{r, echo = FALSE, include = F}

# 2019

sales_all_clean %>% 
  select(name, console, year_of_release, genre, publisher, global_sales, sales_year) %>% 
  filter(genre == "Action") %>% 
  filter(sales_year == 2019) %>% 
  slice_max(global_sales, n = 5)

```

```{r, echo = FALSE}

tibble(
  "2016" = c("Grand Theft Auto V (PS3)", "Grand Theft Auto: San Andreas (PS2)",
             "Grand Theft Auto V (X360)", "Grand Theft Auto: Vice City (PS2)",
             "Grand Theft Auto III (PS2)"),
  
  "2019" = c("Grand Theft Auto V (PS3)", "Grand Theft Auto V (PS4)",
             "Grand Theft Auto: Vice City (PS2)", "Grand Theft Auto V (X360)",
             "Red Dead Redemption 2 (PS4)")
) %>% 
  pander()

```
**Grand Theft Auto** clearly dominates the **Action** category.

<hr>

### Sports Games

```{r, echo = FALSE, include = F}

# 2016

sales_all_clean %>% 
  select(name, console, year_of_release, genre, publisher, global_sales, sales_year) %>% 
  filter(genre == "Sports") %>% 
  filter(sales_year == 2016) %>% 
  slice_max(global_sales, n = 5)

```

```{r, echo = FALSE, include = F}

# 2019

sales_all_clean %>% 
  select(name, console, year_of_release, genre, publisher, global_sales, sales_year) %>% 
  filter(genre == "Sports") %>% 
  filter(sales_year == 2019) %>% 
  slice_max(global_sales, n = 5)

```

```{r, echo = FALSE}

tibble(
  "2016" = c("Wii Sports (Wii)", "Wii Sports Resort (Wii)", "Wii Fit (Wii)",
             "Wii Fit Plus (Wii)", "FIFA 16 (PS4)"),
  
  "2019" = c("FIFA 18 (PS4)", "FIFA 17 (PS4)", "FIFA 19 (PS4)", "FIFA 16 (PS4)",
             "FIFA 13 (PS3)")
) %>% 
  pander()

```
**Wii Sports** clearly wins this category. **FIFA** also highly ranked in this 
category.

<hr>

### Shooter Games

```{r, echo = FALSE, include = F}

sales_all_clean %>% 
  select(name, console, year_of_release, genre, publisher, global_sales, sales_year) %>% 
  filter(genre == "Shooter") %>% 
  filter(sales_year == 2016) %>% 
  slice_max(global_sales, n = 5)

```

```{r, echo = FALSE, include = F}

sales_all_clean %>% 
  select(name, console, year_of_release, genre, publisher, global_sales, sales_year) %>% 
  filter(genre == "Shooter") %>% 
  filter(sales_year == 2019) %>% 
  slice_max(global_sales, n = 5)

```

```{r, echo = FALSE}

tibble(
  "2016" = c("Duck Hunt (NES)", "Call of Duty: Modern Warfare 3 (X360)",
             "Call of Duty: Black Ops 3 (PS4)", "Call of Duty: Black Ops (X360)",
             "Call of Duty: Black Ops II (PS3)"),
  
  "2019" = c("Call of Duty: Black Ops 3 (PS4)", 
             "Call of Duty: Modern Warfare 3 (X360)", 
             "Call of Duty: Black Ops (X360)",
             "Call of Duty: Black Ops II (X360)",
             "Call of Duty: Black Ops II (PS3)"
             )
) %>% 
  pander()

```
**Duck Hunt**, the classic Nintendo game from 1984 tops this category. **Call of Duty** tops the 'modern' games in this category.

<hr>

### Role Playing Games

```{r, echo = FALSE, include = F}

sales_all_clean %>% 
  select(name, console, year_of_release, genre, publisher, global_sales, sales_year) %>% 
  filter(genre == "Role-Playing") %>% 
  filter(sales_year == 2016) %>% 
  slice_max(global_sales, n = 5)

```

```{r, echo = FALSE, include = F}

sales_all_clean %>% 
  select(name, console, year_of_release, genre, publisher, global_sales, sales_year) %>% 
  filter(genre == "Role-Playing") %>% 
  filter(sales_year == 2019) %>% 
  slice_max(global_sales, n = 5)

```

```{r, echo = F}

tibble(
  "2016" = c("Pokemon Red/Pokemon Blue (GB)", "Pokemon Gold/Pokemon Silver (GB)",
             "Pokemon Diamond/Pokemon Pearl (DS)",
             "Pokemon Ruby/Pokemon Sapphire (GBA)",
             "Pokemon Black/Pokemon White (DS)"),
  
  "2019" = c("The Elder Scrolls V: Skyrim (X360)",
             "Fallout 4 (PS4)",
             "The Elder Scrolls V: Skyrim (PS3)",
             "The Witcher 3: Wild Hunt (PS4)",
             "Final Fantasy XIII (PS3)")
) %>% 
  pander()

```
**Pokemon** are the clear winners from this category.

<hr>

### Platform Games

```{r, echo = FALSE, include = F}

sales_all_clean %>% 
  select(name, console, year_of_release, genre, publisher, global_sales, sales_year) %>% 
  filter(genre == "Platform") %>% 
  filter(sales_year == 2016) %>% 
  slice_max(global_sales, n = 5)

```

```{r, echo = FALSE, include = F}

sales_all_clean %>% 
  select(name, console, year_of_release, genre, publisher, global_sales, sales_year) %>% 
  filter(genre == "Platform") %>% 
  filter(sales_year == 2019) %>% 
  slice_max(global_sales, n = 5)

```

```{r, echo = FALSE}

tibble(
  "2016" = c("Super Mario Bros. (NES)",
             "New Super Mario Bros. (DS)",
             "New Super Mario Bros. Wii (Wii)",
             "Super Mario World (SNES)",
             "Super Mario Land (GB)"),
  
  "2019" = c("Crash Bandicoot 2: Cortex Strikes Back (PS)",
             "Crash Bandicoot 3: Warped (PS)",
             "LittleBigPlanet (PS3)",
             "Crash Bandicoot: The Wrath of Cortex (PS2)",
             "Spyro the Dragon (PS)")
) %>% 
  pander()

```
**Super Mario** wins.

<hr>

### Other Games

```{r, echo = FALSE, include = F}

sales_all_clean %>% 
  select(name, console, year_of_release, genre, publisher, global_sales, sales_year) %>% 
  filter(genre == "Other") %>% 
  filter(sales_year == 2016) %>% 
  slice_max(global_sales, n = 5)

```

```{r, echo = FALSE, include = F}

sales_all_clean %>% 
  select(name, console, year_of_release, genre, publisher, global_sales, sales_year) %>% 
  filter(genre == "Other") %>% 
  filter(sales_year == 2019) %>% 
  slice_max(global_sales, n = 5)

```

```{r, echo = FALSE}

tibble(
  "2016" = c("Wii Play (Wii)",
             "Kinect Adventures! (X360)",
             "Brain Age: Train Your Brain in Minutes a Day (DS)",
             "Just Dance 3 (Wii)",
             "Just Dance 2 (Wii)"),
  
  "2019" = c("Just Dance 3 (Wii)",
             "Just Dance 4 (Wii)",
             "Minecraft (PS4)",
             "Minecraft (PS3)",
             "Minecraft (XOne)")
) %>% 
  pander()

```

This is an interesting category as there is quite a mix of top games. It is clear that the Wii is popular, especially with interactive games, such as **Wii Play** and **Just Dance** scoring highly.

<hr>

### Racing Games

```{r, echo = FALSE, include = F}

sales_all_clean %>% 
  select(name, console, year_of_release, genre, publisher, global_sales, sales_year) %>% 
  filter(genre == "Racing") %>% 
  filter(sales_year == 2016) %>% 
  slice_max(global_sales, n = 5)

```

```{r, echo = FALSE, include = F}

sales_all_clean %>% 
  select(name, console, year_of_release, genre, publisher, global_sales, sales_year) %>% 
  filter(genre == "Racing") %>% 
  filter(sales_year == 2019) %>% 
  slice_max(global_sales, n = 5)

```

```{r, echo = FALSE}

tibble(
  "2016" = c("Mario Kart Wii (Wii)",
             "Mario Kart DS (DS)",
             "Gran Turismo 3: A-Spec (PS2)",
             "Mario Kart 7 (3DS)",
             "Gran Turismo 4 (PS2)"),
  
  "2019" = c("Need for Speed Underground (PS2)",
             "Need for Speed Underground 2 (PS2)",
             "Forza Motorsport 3 (X360)",
             "Crash Team Racing (PS)",
             "The Simpsons: Hit & Run (PS2)")
) %>% 
  pander()

```
**Mario Kart** taking lead in this category. Special mention to **Gran Turismo** also as the top 'non-Nintendo' game.

<hr>

### Fighting Games

```{r, echo = FALSE, include = F}

sales_all_clean %>% 
  select(name, console, year_of_release, genre, publisher, global_sales, sales_year) %>% 
  filter(genre == "Fighting") %>% 
  filter(sales_year == 2016) %>% 
  slice_max(global_sales, n = 5)

```

```{r, echo = FALSE, include = F}

sales_all_clean %>% 
  select(name, console, year_of_release, genre, publisher, global_sales, sales_year) %>% 
  filter(genre == "Fighting") %>% 
  filter(sales_year == 2019) %>% 
  slice_max(global_sales, n = 5)

```

```{r, echo = FALSE}

tibble(
  "2016" = c("Super Smash Bros. Brawl (Wii)",
             "Super Smash Bros. for Wii U and 3DS (3DS)",
             "Tekken 3 (PS)",
             "Super Smash Bros. Melee (GC)",
             "Street Fighter II: The World Warrior (SNES)"),
  
  "2019" = c("Tekken 2 (PS)",
             "Street Fighter IV (PS3)",
             "Tekken Tag Tournament (PS2)",
             "WWF SmackDown! (PS)",
             "Mortal Kombat X (PS4)")
) %>% 
  pander()

```
**Super Smash Bros. Brawl** for the Wii taking first place in this category. Classic fighting games such as **Tekken** and **Street Fighter** are very popular.

<hr>

### Simulation Games

```{r, echo = FALSE, include = F}

sales_all_clean %>% 
  select(name, console, year_of_release, genre, publisher, global_sales, sales_year) %>% 
  filter(genre == "Simulation") %>% 
  filter(sales_year == 2016) %>% 
  slice_max(global_sales, n = 5)

```

```{r, echo = FALSE, include = F}

sales_all_clean %>% 
  select(name, console, year_of_release, genre, publisher, global_sales, sales_year) %>% 
  filter(genre == "Simulation") %>% 
  filter(sales_year == 2019) %>% 
  slice_max(global_sales, n = 5)

```

```{r, echo = FALSE}

tibble(
  "2016" = c("Nintendogs (DS)",
             "Animal Crossing: Wild World (DS)",
             "Animal Crossing: New Leaf (3DS)",
             "The Sims 3 (PC)",
             "Cooking Mama (DS)"),
  
  "2019" = c("The Sims 3 (PC)",
             "Cooking Mama (DS)",
             "Microsoft Flight Simulator (PC)",
             "The Sims 4 (PC)",
             "The Sims: Unleashed (PC)")
) %>% 
  pander()

```
Interesting result from this category, **Nintendogs** is top in global sales. **The Sims** and **Animal Crossing** also performing well.

<hr>

### Puzzle Games

```{r, echo = FALSE, include = F}

sales_all_clean %>% 
  select(name, console, year_of_release, genre, publisher, global_sales, sales_year) %>% 
  filter(genre == "Puzzle") %>% 
  filter(sales_year == 2016) %>% 
  slice_max(global_sales, n = 5)

```

```{r, echo = FALSE, include = F}

sales_all_clean %>% 
  select(name, console, year_of_release, genre, publisher, global_sales, sales_year) %>% 
  filter(genre == "Puzzle") %>% 
  filter(sales_year == 2019) %>% 
  slice_max(global_sales, n = 5)

```

```{r, echo = FALSE}

tibble(
  "2016" = c("Tetris (GB)",
             "Brain Age 2: More Training in Minutes a Day (DS)",
             "Pac-Man (2600)",
             "Tetris (NES)",
             "Dr. Mario (NES)"),
  
  "2019" = c("Pac-Man Collection (GBA)",
             "Tetris Plus (PS)",
             "High School Musical: Makin' the Cut! (DS)",
             "Scribblenauts (DS)",
             "Tetris Worlds (PS2)")
) %>% 
  pander()

```

**Tetris** is the top classic puzzle game. **Brain Age** and **Professor Layton** games performed very well in this category.

<hr>

### Adventure Games

```{r, echo = FALSE, include = F}

sales_all_clean %>% 
  select(name, console, year_of_release, genre, publisher, global_sales, sales_year) %>% 
  filter(genre == "Adventure") %>% 
  filter(sales_year == 2016) %>% 
  slice_max(global_sales, n = 5)

```

```{r, echo = FALSE, include = F}

sales_all_clean %>% 
  select(name, console, year_of_release, genre, publisher, global_sales, sales_year) %>% 
  filter(genre == "Adventure") %>% 
  filter(sales_year == 2019) %>% 
  slice_max(global_sales, n = 5)

```

```{r, echo = F}

tibble(
  "2016" = c("Super Mario Land 2: 6 Golden Coins (GB)",
             "Assassin's Creed (X360)",
             "Assassin's Creed (PS3)",
             "Zelda II: The Adventure of Link (NES)",
             "Rugrats: Search For Reptar (PS)"),
  
  "2019" = c("Tomb Raider II (PS)",
             "LEGO Indiana Jones: The Original Adventures (X360)",
             "Tomb Raider III: Adventures of Lara Croft (PS)",
             "LEGO Batman: The Videogame (X360)",
             "Rugrats: Search For Reptar (PS)")
) %>% 
  pander()

```

**Super Mario Land 2: 6 Golden Coins** is the number one 'Adventure' game, released in 1992 for the GameBoy. **Assassin's Creed** is the top 'modern' game in this category.

<hr>

### Strategy Games

```{r, echo = FALSE, include = F}

sales_all_clean %>% 
  select(name, console, year_of_release, genre, publisher, global_sales, sales_year) %>% 
  filter(genre == "Strategy") %>% 
  filter(sales_year == 2016) %>% 
  slice_max(global_sales, n = 5)

```
```{r, echo = FALSE, include = F}

sales_all_clean %>% 
  select(name, console, year_of_release, genre, publisher, global_sales, sales_year) %>% 
  filter(genre == "Strategy") %>% 
  filter(sales_year == 2019) %>% 
  slice_max(global_sales, n = 5)

```

```{r, echo = FALSE}

tibble(
  "2016" = c("Pokemon Stadium (N64)",
             "Warzone 2100 (PS)",
             "StarCraft II: Wings of Liberty (PC)",
             "Warcraft II: Tides of Darkness (PC)",
             "Pokémon Trading Card Game (GB)"),
  
  "2019" = c("Warzone 2100 (PS)",
             "Command & Conquer: Red Alert (PC)",
             "Halo Wars (X360)",
             "Mario + Rabbids: Kingdom Battle (NS)",
             "Theme Hospital (PC)")
) %>% 
  pander()

```

**Pokemon Stadium** is the top game in this category.

<hr>


```{r, include=FALSE}


sales_all_clean %>% 
  filter(year_of_release != "Unknown") %>% 
  summarise(min = min(year_of_release), 
            max = max(year_of_release))

# 1970 to 2020

```

#

```{r, echo = FALSE}

sales_all_clean %>% 
  filter(year_of_release >= "1970" & year_of_release <= "1979") %>% 
  slice_max(global_sales, n = 5) %>% 
  select(name, console, year_of_release, genre, global_sales) 

```

```{r, echo = FALSE}

sales_all_clean %>% 
  filter(year_of_release >= "1970" & year_of_release <= "1979") %>% 
  group_by(genre) %>% 
  summarise(global_sales_millions = sum(global_sales)) %>% 
  arrange(desc(global_sales_millions)) %>% 
  
  ggplot(aes(x = reorder(genre, global_sales_millions), 
             y = global_sales_millions)) +
  geom_col(alpha = 0.8, colour = "white", fill = "#cc9900") +
  coord_flip() +
  theme_light() +
  labs(title = "Top Performing Games Genres", 
       subtitle = "1970s",
       x = "Genre", 
       y = "Global Sales (millions)") +
   scale_y_continuous(breaks = c(0, 0.5, 1, 1.5 ),
                     expand = c(0.025, 0.025))
  
  

```


```{r}

sales_all_clean %>% 
  filter(sales_year == 2016) %>% 
  group_by(genre) %>% 
  summarise(global_sales_millions = sum(global_sales)) %>% 
  arrange(desc(global_sales_millions)) %>% 
  
  ggplot(aes(x = reorder(genre, global_sales_millions), 
             y = global_sales_millions)) +
  geom_col(alpha = 0.8, colour = "white", fill = "#cc9900") +
  coord_flip() +
  theme_light() +
  labs(title = "Top Performing Games Genres", 
       subtitle = "in 2016",
       x = "Genre", 
       y = "Global Sales (millions)") +
   scale_y_continuous(breaks = c(0, 250, 500, 750, 1000, 1250, 1500, 1750),
                     expand = c(0.025, 0.025))


```





